# Modular Pipeline for Gender Bias Migration in Short Texts

## ğŸ’¡ Project Overview

This project aims to detect and mitigate gender bias in sentences generated by large language models (LLMs), especially in cases where gender is ambiguous. The project combines sentence-level gender uncertainty detection with controlled sentence rewriting using GPT models and evaluates the change in bias via embedding-based metrics.

## ğŸ¯ Objectives

- Identify sentences with implicit or uncertain gender bias
- Rewrite these sentences using GPT with a 50% chance of assigning male or female pronouns
- Evaluate the gender bias using cosine similarity to predefined gender key phrases
- Reduce average bias score after rewriting to near zero

## ğŸ§  Methodology

### 1. Gender Uncertainty Detection

- Fine-tuned BERT-based classifier to detect whether a sentence contains implicit gender assumptions

### 2. Gender-Aware Rewriting

- GPT-3.5/4o is prompted to rewrite ambiguous sentences
- Gender is randomly assigned (p = 0.5 for male/female)

### 3. Bias Evaluation

- Sentence embeddings are computed using `SentenceTransformer`
- Cosine distance is measured between sentence and gender phrases: `"man"` and `"woman"`
- Final score = dist(woman) - dist(man), averaged over biased examples

## ğŸ“Š Dataset

- Pairs of short narrative sentences
- Each pair includes a neutral sentence and a follow-up sentence
- Labels: `1` = contains gender bias, `0` = neutral
- Dataset is partly synthetic and partly curated manually

## ğŸ“ˆ Results Summary

| Stage           | Avg. Bias Score |
| --------------- | --------------- |
| Original        | High (biased)   |
| After Rewriting | Near Zero       |

- BERT classifier achieves XX% accuracy (replace with actual result)
- GPT rewrites significantly reduce measured bias

## ğŸ§ª Metrics

- Cosine similarity from `SentenceTransformer` embeddings
- Bias Score: `cos(woman) - cos(man)`
- Evaluation before and after rewrite

## ğŸ“ Project Structure

```
ProjectNLP/
â”‚
â”œâ”€â”€ ProjectNLP.ipynb          # Main notebook
â”œâ”€â”€ data/
â”‚   â””â”€â”€ sentences.csv         # Input sentence pairs with bias labels
â”œâ”€â”€ outputs/
â”‚   â”œâ”€â”€ rewritten.csv         # GPT rewritten sentences
â”‚   â””â”€â”€ embeddings.csv        # Sentence embedding vectors
â”œâ”€â”€ utils.py                  # Utility functions for embeddings, distance, and GPT prompts
â””â”€â”€ README.md                 # This file
```

## ğŸ”§ Requirements

- Python 3.9+
- OpenAI API key
- `transformers`, `sentence-transformers`, `scikit-learn`, `pandas`, `numpy`

Install via:

```bash
pip install -r requirements.txt
```

## ğŸ§  Future Work

- Expand bias dimensions (race, age, etc.)
- Extend to full document-level rewriting
- Real-time interactive rewriting API
